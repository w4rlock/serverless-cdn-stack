Resources:
  StaticWebSiteBucket:
    Type: 'AWS::S3::Bucket'
    DeletionPolicy: Retain
    Properties:
      AccessControl: Private
      BucketName: {{ bucketName }}

      {{#if bucketVersioning }}
      VersioningConfiguration:
        Status: Enabled
      {{/if}}

      {{#if bucketEncryption }}
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256
      {{/if}}

      WebsiteConfiguration:
        IndexDocument: {{ indexPage }}
        ErrorDocument: {{ errorPage }}

      {{#if blockPublicAccess }}
      PublicAccessBlockConfiguration:
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
      {{/if}}

Outputs:
  BucketWebSite:
    Description: 'Static web site bucket url'
    Value:
      Fn::Sub: 'https://s3.console.aws.amazon.com/s3/buckets/${StaticWebSiteBucket}'
